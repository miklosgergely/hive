PREHOOK: query: select key from(
select '1' as key from srcpart where ds="2008-04-09"
UNION all
SELECT key from srcpart where ds="2008-04-09" and hr="11"
) tab group by key
PREHOOK: type: QUERY
PREHOOK: Input: default@srcpart
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
POSTHOOK: query: select key from(
select '1' as key from srcpart where ds="2008-04-09"
UNION all
SELECT key from srcpart where ds="2008-04-09" and hr="11"
) tab group by key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcpart
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
1
10
100
104
105
113
116
118
125
126
129
131
136
143
145
146
15
152
153
156
158
160
163
164
165
167
17
170
174
175
178
179
18
181
189
19
190
191
193
200
201
203
207
209
213
216
222
223
228
229
235
239
24
244
247
248
249
26
263
266
27
272
273
274
28
280
282
283
284
286
289
298
302
305
306
308
311
317
322
323
325
327
33
331
333
336
339
341
345
35
353
360
362
364
365
369
375
377
378
379
392
393
394
399
4
402
406
409
41
411
418
419
42
421
424
43
431
435
436
437
438
439
443
448
449
453
454
455
457
458
459
460
462
466
467
469
47
472
478
479
480
484
485
490
492
493
496
497
498
53
54
57
58
66
67
69
70
77
82
84
90
97
98
0
103
11
111
114
119
12
120
128
133
134
137
138
149
150
155
157
162
166
168
169
172
176
177
180
183
186
187
192
194
195
196
197
199
2
20
202
205
208
214
217
218
219
221
224
226
230
233
237
238
241
242
252
255
256
257
258
260
262
265
275
277
278
281
285
287
288
291
292
296
30
307
309
310
315
316
318
321
332
335
338
34
342
344
348
351
356
366
367
368
37
373
374
382
384
386
389
395
396
397
400
401
403
404
407
413
414
417
427
429
430
432
44
444
446
452
463
468
470
475
477
481
482
483
487
489
491
494
495
5
51
64
65
72
74
76
78
8
80
83
85
86
87
9
92
95
96
PREHOOK: query: select key from(
SELECT '1' as key from src
UNION all
SELECT key as key from src
) tab group by key
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select key from(
SELECT '1' as key from src
UNION all
SELECT key as key from src
) tab group by key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
1
10
100
104
105
113
116
118
125
126
129
131
136
143
145
146
15
152
153
156
158
160
163
164
165
167
17
170
174
175
178
179
18
181
189
19
190
191
193
200
201
203
207
209
213
216
222
223
228
229
235
239
24
244
247
248
249
26
263
266
27
272
273
274
28
280
282
283
284
286
289
298
302
305
306
308
311
317
322
323
325
327
33
331
333
336
339
341
345
35
353
360
362
364
365
369
375
377
378
379
392
393
394
399
4
402
406
409
41
411
418
419
42
421
424
43
431
435
436
437
438
439
443
448
449
453
454
455
457
458
459
460
462
466
467
469
47
472
478
479
480
484
485
490
492
493
496
497
498
53
54
57
58
66
67
69
70
77
82
84
90
97
98
0
103
11
111
114
119
12
120
128
133
134
137
138
149
150
155
157
162
166
168
169
172
176
177
180
183
186
187
192
194
195
196
197
199
2
20
202
205
208
214
217
218
219
221
224
226
230
233
237
238
241
242
252
255
256
257
258
260
262
265
275
277
278
281
285
287
288
291
292
296
30
307
309
310
315
316
318
321
332
335
338
34
342
344
348
351
356
366
367
368
37
373
374
382
384
386
389
395
396
397
400
401
403
404
407
413
414
417
427
429
430
432
44
444
446
452
463
468
470
475
477
481
482
483
487
489
491
494
495
5
51
64
65
72
74
76
78
8
80
83
85
86
87
9
92
95
96
PREHOOK: query: select max(key) from(
SELECT '1' as key from src
UNION all
SELECT key as key from src
) tab group by key
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select max(key) from(
SELECT '1' as key from src
UNION all
SELECT key as key from src
) tab group by key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
1
10
100
104
105
113
116
118
125
126
129
131
136
143
145
146
15
152
153
156
158
160
163
164
165
167
17
170
174
175
178
179
18
181
189
19
190
191
193
200
201
203
207
209
213
216
222
223
228
229
235
239
24
244
247
248
249
26
263
266
27
272
273
274
28
280
282
283
284
286
289
298
302
305
306
308
311
317
322
323
325
327
33
331
333
336
339
341
345
35
353
360
362
364
365
369
375
377
378
379
392
393
394
399
4
402
406
409
41
411
418
419
42
421
424
43
431
435
436
437
438
439
443
448
449
453
454
455
457
458
459
460
462
466
467
469
47
472
478
479
480
484
485
490
492
493
496
497
498
53
54
57
58
66
67
69
70
77
82
84
90
97
98
0
103
11
111
114
119
12
120
128
133
134
137
138
149
150
155
157
162
166
168
169
172
176
177
180
183
186
187
192
194
195
196
197
199
2
20
202
205
208
214
217
218
219
221
224
226
230
233
237
238
241
242
252
255
256
257
258
260
262
265
275
277
278
281
285
287
288
291
292
296
30
307
309
310
315
316
318
321
332
335
338
34
342
344
348
351
356
366
367
368
37
373
374
382
384
386
389
395
396
397
400
401
403
404
407
413
414
417
427
429
430
432
44
444
446
452
463
468
470
475
477
481
482
483
487
489
491
494
495
5
51
64
65
72
74
76
78
8
80
83
85
86
87
9
92
95
96
PREHOOK: query: select key from(
SELECT '1' as key from src
UNION all
SELECT '2' as key from src
) tab group by key
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select key from(
SELECT '1' as key from src
UNION all
SELECT '2' as key from src
) tab group by key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
1
2
PREHOOK: query: select key from(
SELECT '1' as key from src
UNION all
SELECT key as key from src
UNION all
SELECT '2' as key from src
UNION all
SELECT key as key from src
) tab group by key
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select key from(
SELECT '1' as key from src
UNION all
SELECT key as key from src
UNION all
SELECT '2' as key from src
UNION all
SELECT key as key from src
) tab group by key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
1
10
100
104
105
113
116
118
125
126
129
131
136
143
145
146
15
152
153
156
158
160
163
164
165
167
17
170
174
175
178
179
18
181
189
19
190
191
193
200
201
203
207
209
213
216
222
223
228
229
235
239
24
244
247
248
249
26
263
266
27
272
273
274
28
280
282
283
284
286
289
298
302
305
306
308
311
317
322
323
325
327
33
331
333
336
339
341
345
35
353
360
362
364
365
369
375
377
378
379
392
393
394
399
4
402
406
409
41
411
418
419
42
421
424
43
431
435
436
437
438
439
443
448
449
453
454
455
457
458
459
460
462
466
467
469
47
472
478
479
480
484
485
490
492
493
496
497
498
53
54
57
58
66
67
69
70
77
82
84
90
97
98
0
103
11
111
114
119
12
120
128
133
134
137
138
149
150
155
157
162
166
168
169
172
176
177
180
183
186
187
192
194
195
196
197
199
2
20
202
205
208
214
217
218
219
221
224
226
230
233
237
238
241
242
252
255
256
257
258
260
262
265
275
277
278
281
285
287
288
291
292
296
30
307
309
310
315
316
318
321
332
335
338
34
342
344
348
351
356
366
367
368
37
373
374
382
384
386
389
395
396
397
400
401
403
404
407
413
414
417
427
429
430
432
44
444
446
452
463
468
470
475
477
481
482
483
487
489
491
494
495
5
51
64
65
72
74
76
78
8
80
83
85
86
87
9
92
95
96
PREHOOK: query: select k from (select * from (SELECT '1' as k from src limit 0)a union all select key as k from src limit 1)tab
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select k from (select * from (SELECT '1' as k from src limit 0)a union all select key as k from src limit 1)tab
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
238
PREHOOK: query: select k from (select * from (SELECT '1' as k from src limit 1)a union all select key as k from src limit 0)tab
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select k from (select * from (SELECT '1' as k from src limit 1)a union all select key as k from src limit 0)tab
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
PREHOOK: query: select max(ds) from srcpart
PREHOOK: type: QUERY
PREHOOK: Input: default@srcpart
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
POSTHOOK: query: select max(ds) from srcpart
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcpart
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
2008-04-09
PREHOOK: query: select count(ds) from srcpart
PREHOOK: type: QUERY
PREHOOK: Input: default@srcpart
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
POSTHOOK: query: select count(ds) from srcpart
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcpart
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
2000
