PREHOOK: query: DROP TABLE insert_into5a
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE insert_into5a
POSTHOOK: type: DROPTABLE
PREHOOK: query: DROP TABLE insert_into5b
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE insert_into5b
POSTHOOK: type: DROPTABLE
PREHOOK: query: CREATE TABLE insert_into5a (key int, value string)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@insert_into5a
POSTHOOK: query: CREATE TABLE insert_into5a (key int, value string)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@insert_into5a
PREHOOK: query: CREATE TABLE insert_into5b (key int, value string) PARTITIONED BY (ds string)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@insert_into5b
POSTHOOK: query: CREATE TABLE insert_into5b (key int, value string) PARTITIONED BY (ds string)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@insert_into5b
PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into5a SELECT 1, 'one' FROM src LIMIT 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@insert_into5a
POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into5a SELECT 1, 'one' FROM src LIMIT 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@insert_into5a
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (CUSTOM_SIMPLE_EDGE)

Stage-3
  Stats Work{}
    Stage-0
      Move Operator
        table:{"name:":"default.insert_into5a"}
        Stage-2
          Dependency Collection{}
            Stage-1
              Reducer 3
              File Output Operator [FS_13]
                Group By Operator [GBY_11] (rows=1 width=880)
                  Output:["_col0","_col1"],aggregations:["compute_stats(VALUE._col0)","compute_stats(VALUE._col1)"]
                <-Reducer 2 [CUSTOM_SIMPLE_EDGE]
                  File Output Operator [FS_6]
                    table:{"name:":"default.insert_into5a"}
                    Limit [LIM_5] (rows=10 width=91)
                      Number of rows:10
                      Select Operator [SEL_4] (rows=10 width=91)
                        Output:["_col0","_col1"]
                      <-Map 1 [CUSTOM_SIMPLE_EDGE] vectorized
                        PARTITION_ONLY_SHUFFLE [RS_16]
                          Limit [LIM_15] (rows=10 width=91)
                            Number of rows:10
                            Select Operator [SEL_14] (rows=500 width=91)
                              Output:["_col0","_col1"]
                              TableScan [TS_0] (rows=500 width=10)
                                default@src,src,Tbl:COMPLETE,Col:COMPLETE
                  PARTITION_ONLY_SHUFFLE [RS_10]
                    Group By Operator [GBY_9] (rows=1 width=864)
                      Output:["_col0","_col1"],aggregations:["compute_stats(key, 'hll')","compute_stats(value, 'hll')"]
                      Select Operator [SEL_8] (rows=10 width=91)
                        Output:["key","value"]
                         Please refer to the previous Limit [LIM_5]

PREHOOK: query: INSERT INTO TABLE insert_into5a SELECT 1, 'one' FROM src LIMIT 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@insert_into5a
POSTHOOK: query: INSERT INTO TABLE insert_into5a SELECT 1, 'one' FROM src LIMIT 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@insert_into5a
POSTHOOK: Lineage: insert_into5a.key SIMPLE []
POSTHOOK: Lineage: insert_into5a.value SIMPLE []
PREHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into5a
) t
PREHOOK: type: QUERY
PREHOOK: Input: default@insert_into5a
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into5a
) t
POSTHOOK: type: QUERY
POSTHOOK: Input: default@insert_into5a
POSTHOOK: Output: hdfs://### HDFS PATH ###
481928560
PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into5a SELECT * FROM insert_into5a
PREHOOK: type: QUERY
PREHOOK: Input: default@insert_into5a
PREHOOK: Output: default@insert_into5a
POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into5a SELECT * FROM insert_into5a
POSTHOOK: type: QUERY
POSTHOOK: Input: default@insert_into5a
POSTHOOK: Output: default@insert_into5a
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE)

Stage-3
  Stats Work{}
    Stage-0
      Move Operator
        table:{"name:":"default.insert_into5a"}
        Stage-2
          Dependency Collection{}
            Stage-1
              Reducer 2
              File Output Operator [FS_9]
                Group By Operator [GBY_7] (rows=1 width=880)
                  Output:["_col0","_col1"],aggregations:["compute_stats(VALUE._col0)","compute_stats(VALUE._col1)"]
                <-Map 1 [CUSTOM_SIMPLE_EDGE]
                  File Output Operator [FS_2]
                    table:{"name:":"default.insert_into5a"}
                    Select Operator [SEL_1] (rows=10 width=91)
                      Output:["_col0","_col1"]
                      TableScan [TS_0] (rows=10 width=91)
                        default@insert_into5a,insert_into5a,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                  PARTITION_ONLY_SHUFFLE [RS_6]
                    Group By Operator [GBY_5] (rows=1 width=864)
                      Output:["_col0","_col1"],aggregations:["compute_stats(key, 'hll')","compute_stats(value, 'hll')"]
                      Select Operator [SEL_4] (rows=10 width=91)
                        Output:["key","value"]
                         Please refer to the previous Select Operator [SEL_1]

PREHOOK: query: INSERT INTO TABLE insert_into5a SELECT * FROM insert_into5a
PREHOOK: type: QUERY
PREHOOK: Input: default@insert_into5a
PREHOOK: Output: default@insert_into5a
POSTHOOK: query: INSERT INTO TABLE insert_into5a SELECT * FROM insert_into5a
POSTHOOK: type: QUERY
POSTHOOK: Input: default@insert_into5a
POSTHOOK: Output: default@insert_into5a
POSTHOOK: Lineage: insert_into5a.key SIMPLE [(insert_into5a)insert_into5a.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: insert_into5a.value SIMPLE [(insert_into5a)insert_into5a.FieldSchema(name:value, type:string, comment:null), ]
PREHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into5a
) t
PREHOOK: type: QUERY
PREHOOK: Input: default@insert_into5a
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into5a
) t
POSTHOOK: type: QUERY
POSTHOOK: Input: default@insert_into5a
POSTHOOK: Output: hdfs://### HDFS PATH ###
963857120
PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into5b PARTITION (ds='1') 
  SELECT * FROM insert_into5a
PREHOOK: type: QUERY
PREHOOK: Input: default@insert_into5a
PREHOOK: Output: default@insert_into5b@ds=1
POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into5b PARTITION (ds='1') 
  SELECT * FROM insert_into5a
POSTHOOK: type: QUERY
POSTHOOK: Input: default@insert_into5a
POSTHOOK: Output: default@insert_into5b@ds=1
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-3
  Stats Work{}
    Stage-0
      Move Operator
        table:{"name:":"default.insert_into5b"}
        Stage-2
          Dependency Collection{}
            Stage-1
              Reducer 2
              File Output Operator [FS_9]
                Select Operator [SEL_8] (rows=1 width=965)
                  Output:["_col0","_col1","_col2"]
                  Group By Operator [GBY_7] (rows=1 width=965)
                    Output:["_col0","_col1","_col2"],aggregations:["compute_stats(VALUE._col0)","compute_stats(VALUE._col1)"],keys:KEY._col0
                  <-Map 1 [SIMPLE_EDGE]
                    File Output Operator [FS_2]
                      table:{"name:":"default.insert_into5b"}
                      Select Operator [SEL_1] (rows=20 width=91)
                        Output:["_col0","_col1"]
                        TableScan [TS_0] (rows=20 width=91)
                          default@insert_into5a,insert_into5a,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                    SHUFFLE [RS_6]
                      PartitionCols:_col0
                      Group By Operator [GBY_5] (rows=1 width=949)
                        Output:["_col0","_col1","_col2"],aggregations:["compute_stats(key, 'hll')","compute_stats(value, 'hll')"],keys:ds
                        Select Operator [SEL_4] (rows=20 width=176)
                          Output:["key","value","ds"]
                           Please refer to the previous Select Operator [SEL_1]

PREHOOK: query: INSERT INTO TABLE insert_into5b PARTITION (ds='1') SELECT * FROM insert_into5a
PREHOOK: type: QUERY
PREHOOK: Input: default@insert_into5a
PREHOOK: Output: default@insert_into5b@ds=1
POSTHOOK: query: INSERT INTO TABLE insert_into5b PARTITION (ds='1') SELECT * FROM insert_into5a
POSTHOOK: type: QUERY
POSTHOOK: Input: default@insert_into5a
POSTHOOK: Output: default@insert_into5b@ds=1
POSTHOOK: Lineage: insert_into5b PARTITION(ds=1).key SIMPLE [(insert_into5a)insert_into5a.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: insert_into5b PARTITION(ds=1).value SIMPLE [(insert_into5a)insert_into5a.FieldSchema(name:value, type:string, comment:null), ]
PREHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into5b
) t
PREHOOK: type: QUERY
PREHOOK: Input: default@insert_into5b
PREHOOK: Input: default@insert_into5b@ds=1
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into5b
) t
POSTHOOK: type: QUERY
POSTHOOK: Input: default@insert_into5b
POSTHOOK: Input: default@insert_into5b@ds=1
POSTHOOK: Output: hdfs://### HDFS PATH ###
-18626052920
PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into5b PARTITION (ds='1')
  SELECT key, value FROM insert_into5b
PREHOOK: type: QUERY
PREHOOK: Input: default@insert_into5b
PREHOOK: Input: default@insert_into5b@ds=1
PREHOOK: Output: default@insert_into5b@ds=1
POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into5b PARTITION (ds='1')
  SELECT key, value FROM insert_into5b
POSTHOOK: type: QUERY
POSTHOOK: Input: default@insert_into5b
POSTHOOK: Input: default@insert_into5b@ds=1
POSTHOOK: Output: default@insert_into5b@ds=1
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-3
  Stats Work{}
    Stage-0
      Move Operator
        table:{"name:":"default.insert_into5b"}
        Stage-2
          Dependency Collection{}
            Stage-1
              Reducer 2
              File Output Operator [FS_9]
                Select Operator [SEL_8] (rows=1 width=965)
                  Output:["_col0","_col1","_col2"]
                  Group By Operator [GBY_7] (rows=1 width=965)
                    Output:["_col0","_col1","_col2"],aggregations:["compute_stats(VALUE._col0)","compute_stats(VALUE._col1)"],keys:KEY._col0
                  <-Map 1 [SIMPLE_EDGE]
                    File Output Operator [FS_2]
                      table:{"name:":"default.insert_into5b"}
                      Select Operator [SEL_1] (rows=20 width=91)
                        Output:["_col0","_col1"]
                        TableScan [TS_0] (rows=20 width=91)
                          default@insert_into5b,insert_into5b,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                    SHUFFLE [RS_6]
                      PartitionCols:_col0
                      Group By Operator [GBY_5] (rows=1 width=949)
                        Output:["_col0","_col1","_col2"],aggregations:["compute_stats(key, 'hll')","compute_stats(value, 'hll')"],keys:ds
                        Select Operator [SEL_4] (rows=20 width=176)
                          Output:["key","value","ds"]
                           Please refer to the previous Select Operator [SEL_1]

PREHOOK: query: INSERT INTO TABLE insert_into5b PARTITION (ds='1') 
  SELECT key, value FROM insert_into5b
PREHOOK: type: QUERY
PREHOOK: Input: default@insert_into5b
PREHOOK: Input: default@insert_into5b@ds=1
PREHOOK: Output: default@insert_into5b@ds=1
POSTHOOK: query: INSERT INTO TABLE insert_into5b PARTITION (ds='1') 
  SELECT key, value FROM insert_into5b
POSTHOOK: type: QUERY
POSTHOOK: Input: default@insert_into5b
POSTHOOK: Input: default@insert_into5b@ds=1
POSTHOOK: Output: default@insert_into5b@ds=1
POSTHOOK: Lineage: insert_into5b PARTITION(ds=1).key SIMPLE [(insert_into5b)insert_into5b.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: insert_into5b PARTITION(ds=1).value SIMPLE [(insert_into5b)insert_into5b.FieldSchema(name:value, type:string, comment:null), ]
PREHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into5b
) t
PREHOOK: type: QUERY
PREHOOK: Input: default@insert_into5b
PREHOOK: Input: default@insert_into5b@ds=1
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into5b
) t
POSTHOOK: type: QUERY
POSTHOOK: Input: default@insert_into5b
POSTHOOK: Input: default@insert_into5b@ds=1
POSTHOOK: Output: hdfs://### HDFS PATH ###
-37252105840
PREHOOK: query: DROP TABLE insert_into5a
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@insert_into5a
PREHOOK: Output: default@insert_into5a
POSTHOOK: query: DROP TABLE insert_into5a
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@insert_into5a
POSTHOOK: Output: default@insert_into5a
