PREHOOK: query: CREATE TABLE dest1_n94(key STRING, value STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@dest1_n94
POSTHOOK: query: CREATE TABLE dest1_n94(key STRING, value STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@dest1_n94
PREHOOK: query: EXPLAIN
FROM (
  FROM src_thrift
  SELECT TRANSFORM(src_thrift.lint, src_thrift.lintstring)
         USING 'cat' AS (tkey, tvalue) 
  CLUSTER BY tkey 
) tmap
INSERT OVERWRITE TABLE dest1_n94 SELECT tmap.tkey, tmap.tvalue
PREHOOK: type: QUERY
PREHOOK: Input: default@src_thrift
PREHOOK: Output: default@dest1_n94
POSTHOOK: query: EXPLAIN
FROM (
  FROM src_thrift
  SELECT TRANSFORM(src_thrift.lint, src_thrift.lintstring)
         USING 'cat' AS (tkey, tvalue) 
  CLUSTER BY tkey 
) tmap
INSERT OVERWRITE TABLE dest1_n94 SELECT tmap.tkey, tmap.tvalue
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src_thrift
POSTHOOK: Output: default@dest1_n94
Plan not optimized by CBO because the statement has cluster by; uses scripts

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (CUSTOM_SIMPLE_EDGE)

Stage-3
  Stats Work{}
    Stage-0
      Move Operator
        table:{"name:":"default.dest1_n94"}
        Stage-2
          Dependency Collection{}
            Stage-1
              Reducer 3
              File Output Operator [FS_13]
                Group By Operator [GBY_11] (rows=1 width=3560)
                  Output:["_col0","_col1"],aggregations:["compute_stats(VALUE._col0)","compute_stats(VALUE._col1)"]
                <-Reducer 2 [CUSTOM_SIMPLE_EDGE]
                  File Output Operator [FS_6]
                    table:{"name:":"default.dest1_n94"}
                    Select Operator [SEL_4] (rows=11 width=2680)
                      Output:["_col0","_col1"]
                    <-Map 1 [SIMPLE_EDGE]
                      SHUFFLE [RS_3]
                        PartitionCols:_col0
                        Transform Operator [SCR_2] (rows=11 width=2680)
                          command:cat
                          Select Operator [SEL_1] (rows=11 width=2680)
                            Output:["_col0","_col1"]
                            TableScan [TS_0] (rows=11 width=2680)
                              default@src_thrift,src_thrift,Tbl:COMPLETE,Col:NONE,Output:["lint","lintstring"]
                  PARTITION_ONLY_SHUFFLE [RS_10]
                    Group By Operator [GBY_9] (rows=1 width=3560)
                      Output:["_col0","_col1"],aggregations:["compute_stats(key, 'hll')","compute_stats(value, 'hll')"]
                      Select Operator [SEL_8] (rows=11 width=2680)
                        Output:["key","value"]
                         Please refer to the previous Select Operator [SEL_4]

PREHOOK: query: FROM (
  FROM src_thrift
  SELECT TRANSFORM(src_thrift.lint, src_thrift.lintstring)
         USING 'cat' AS (tkey, tvalue) 
  CLUSTER BY tkey 
) tmap
INSERT OVERWRITE TABLE dest1_n94 SELECT tmap.tkey, tmap.tvalue
PREHOOK: type: QUERY
PREHOOK: Input: default@src_thrift
PREHOOK: Output: default@dest1_n94
POSTHOOK: query: FROM (
  FROM src_thrift
  SELECT TRANSFORM(src_thrift.lint, src_thrift.lintstring)
         USING 'cat' AS (tkey, tvalue) 
  CLUSTER BY tkey 
) tmap
INSERT OVERWRITE TABLE dest1_n94 SELECT tmap.tkey, tmap.tvalue
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src_thrift
POSTHOOK: Output: default@dest1_n94
POSTHOOK: Lineage: dest1_n94.key SCRIPT [(src_thrift)src_thrift.FieldSchema(name:lint, type:array<int>, comment:from deserializer), (src_thrift)src_thrift.FieldSchema(name:lintstring, type:array<struct<myint:int,mystring:string,underscore_int:int>>, comment:from deserializer), ]
POSTHOOK: Lineage: dest1_n94.value SCRIPT [(src_thrift)src_thrift.FieldSchema(name:lint, type:array<int>, comment:from deserializer), (src_thrift)src_thrift.FieldSchema(name:lintstring, type:array<struct<myint:int,mystring:string,underscore_int:int>>, comment:from deserializer), ]
PREHOOK: query: SELECT dest1_n94.* FROM dest1_n94
PREHOOK: type: QUERY
PREHOOK: Input: default@dest1_n94
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: SELECT dest1_n94.* FROM dest1_n94
POSTHOOK: type: QUERY
POSTHOOK: Input: default@dest1_n94
POSTHOOK: Output: hdfs://### HDFS PATH ###
NULL	NULL
[0,0,0]	[{"myint":0,"mystring":"0","underscore_int":0}]
[1,2,3]	[{"myint":1,"mystring":"1","underscore_int":1}]
[2,4,6]	[{"myint":4,"mystring":"8","underscore_int":2}]
[3,6,9]	[{"myint":9,"mystring":"27","underscore_int":3}]
[4,8,12]	[{"myint":16,"mystring":"64","underscore_int":4}]
[5,10,15]	[{"myint":25,"mystring":"125","underscore_int":5}]
[6,12,18]	[{"myint":36,"mystring":"216","underscore_int":6}]
[7,14,21]	[{"myint":49,"mystring":"343","underscore_int":7}]
[8,16,24]	[{"myint":64,"mystring":"512","underscore_int":8}]
[9,18,27]	[{"myint":81,"mystring":"729","underscore_int":9}]
