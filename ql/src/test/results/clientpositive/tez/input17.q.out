PREHOOK: query: CREATE TABLE dest1_n81(key INT, value STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@dest1_n81
POSTHOOK: query: CREATE TABLE dest1_n81(key INT, value STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@dest1_n81
PREHOOK: query: EXPLAIN
FROM (
  FROM src_thrift
  SELECT TRANSFORM(src_thrift.aint + src_thrift.lint[0], src_thrift.lintstring[0])
         USING 'cat' AS (tkey, tvalue) 
  CLUSTER BY tkey 
) tmap
INSERT OVERWRITE TABLE dest1_n81 SELECT tmap.tkey, tmap.tvalue
PREHOOK: type: QUERY
PREHOOK: Input: default@src_thrift
PREHOOK: Output: default@dest1_n81
POSTHOOK: query: EXPLAIN
FROM (
  FROM src_thrift
  SELECT TRANSFORM(src_thrift.aint + src_thrift.lint[0], src_thrift.lintstring[0])
         USING 'cat' AS (tkey, tvalue) 
  CLUSTER BY tkey 
) tmap
INSERT OVERWRITE TABLE dest1_n81 SELECT tmap.tkey, tmap.tvalue
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src_thrift
POSTHOOK: Output: default@dest1_n81
Plan not optimized by CBO because the statement has cluster by; uses scripts

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)
Reducer 3 <- Reducer 2 (CUSTOM_SIMPLE_EDGE)

Stage-3
  Stats Work{}
    Stage-0
      Move Operator
        table:{"name:":"default.dest1_n81"}
        Stage-2
          Dependency Collection{}
            Stage-1
              Reducer 3
              File Output Operator [FS_14]
                Group By Operator [GBY_12] (rows=1 width=3564)
                  Output:["_col0","_col1"],aggregations:["compute_stats(VALUE._col0)","compute_stats(VALUE._col1)"]
                <-Reducer 2 [CUSTOM_SIMPLE_EDGE]
                  File Output Operator [FS_7]
                    table:{"name:":"default.dest1_n81"}
                    Select Operator [SEL_4] (rows=11 width=2684)
                      Output:["_col0","_col1"]
                    <-Map 1 [SIMPLE_EDGE]
                      SHUFFLE [RS_3]
                        PartitionCols:_col0
                        Transform Operator [SCR_2] (rows=11 width=2684)
                          command:cat
                          Select Operator [SEL_1] (rows=11 width=2684)
                            Output:["_col0","_col1"]
                            TableScan [TS_0] (rows=11 width=2684)
                              default@src_thrift,src_thrift,Tbl:COMPLETE,Col:NONE,Output:["aint","lint","lintstring"]
                  PARTITION_ONLY_SHUFFLE [RS_11]
                    Group By Operator [GBY_10] (rows=1 width=3548)
                      Output:["_col0","_col1"],aggregations:["compute_stats(key, 'hll')","compute_stats(value, 'hll')"]
                      Select Operator [SEL_9] (rows=11 width=2684)
                        Output:["key","value"]
                         Please refer to the previous Select Operator [SEL_4]

PREHOOK: query: FROM (
  FROM src_thrift
  SELECT TRANSFORM(src_thrift.aint + src_thrift.lint[0], src_thrift.lintstring[0])
         USING 'cat' AS (tkey, tvalue) 
  CLUSTER BY tkey 
) tmap
INSERT OVERWRITE TABLE dest1_n81 SELECT tmap.tkey, tmap.tvalue
PREHOOK: type: QUERY
PREHOOK: Input: default@src_thrift
PREHOOK: Output: default@dest1_n81
POSTHOOK: query: FROM (
  FROM src_thrift
  SELECT TRANSFORM(src_thrift.aint + src_thrift.lint[0], src_thrift.lintstring[0])
         USING 'cat' AS (tkey, tvalue) 
  CLUSTER BY tkey 
) tmap
INSERT OVERWRITE TABLE dest1_n81 SELECT tmap.tkey, tmap.tvalue
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src_thrift
POSTHOOK: Output: default@dest1_n81
POSTHOOK: Lineage: dest1_n81.key SCRIPT [(src_thrift)src_thrift.FieldSchema(name:aint, type:int, comment:from deserializer), (src_thrift)src_thrift.FieldSchema(name:lint, type:array<int>, comment:from deserializer), (src_thrift)src_thrift.FieldSchema(name:lintstring, type:array<struct<myint:int,mystring:string,underscore_int:int>>, comment:from deserializer), ]
POSTHOOK: Lineage: dest1_n81.value SCRIPT [(src_thrift)src_thrift.FieldSchema(name:aint, type:int, comment:from deserializer), (src_thrift)src_thrift.FieldSchema(name:lint, type:array<int>, comment:from deserializer), (src_thrift)src_thrift.FieldSchema(name:lintstring, type:array<struct<myint:int,mystring:string,underscore_int:int>>, comment:from deserializer), ]
PREHOOK: query: SELECT dest1_n81.* FROM dest1_n81
PREHOOK: type: QUERY
PREHOOK: Input: default@dest1_n81
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: SELECT dest1_n81.* FROM dest1_n81
POSTHOOK: type: QUERY
POSTHOOK: Input: default@dest1_n81
POSTHOOK: Output: hdfs://### HDFS PATH ###
-1461153966	{"myint":49,"mystring":"343","underscore_int":7}
-1952710705	{"myint":25,"mystring":"125","underscore_int":5}
-734328905	{"myint":16,"mystring":"64","underscore_int":4}
-751827636	{"myint":4,"mystring":"8","underscore_int":2}
1244525196	{"myint":36,"mystring":"216","underscore_int":6}
1638581586	{"myint":64,"mystring":"512","underscore_int":8}
1712634731	{"myint":0,"mystring":"0","underscore_int":0}
336964422	{"myint":81,"mystring":"729","underscore_int":9}
465985201	{"myint":1,"mystring":"1","underscore_int":1}
477111225	{"myint":9,"mystring":"27","underscore_int":3}
NULL	NULL
