PREHOOK: query: DROP TABLE orc_createas1a
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE orc_createas1a
POSTHOOK: type: DROPTABLE
PREHOOK: query: DROP TABLE orc_createas1b
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE orc_createas1b
POSTHOOK: type: DROPTABLE
PREHOOK: query: DROP TABLE orc_createas1c
PREHOOK: type: DROPTABLE
POSTHOOK: query: DROP TABLE orc_createas1c
POSTHOOK: type: DROPTABLE
PREHOOK: query: CREATE TABLE orc_createas1a (key INT, value STRING)
    PARTITIONED BY (ds string)
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@orc_createas1a
POSTHOOK: query: CREATE TABLE orc_createas1a (key INT, value STRING)
    PARTITIONED BY (ds string)
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@orc_createas1a
PREHOOK: query: INSERT OVERWRITE TABLE orc_createas1a PARTITION (ds='1')
    SELECT * FROM src
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@orc_createas1a@ds=1
POSTHOOK: query: INSERT OVERWRITE TABLE orc_createas1a PARTITION (ds='1')
    SELECT * FROM src
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@orc_createas1a@ds=1
POSTHOOK: Lineage: orc_createas1a PARTITION(ds=1).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: orc_createas1a PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: INSERT OVERWRITE TABLE orc_createas1a PARTITION (ds='2')
    SELECT * FROM src
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@orc_createas1a@ds=2
POSTHOOK: query: INSERT OVERWRITE TABLE orc_createas1a PARTITION (ds='2')
    SELECT * FROM src
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@orc_createas1a@ds=2
POSTHOOK: Lineage: orc_createas1a PARTITION(ds=2).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: orc_createas1a PARTITION(ds=2).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: EXPLAIN CREATE TABLE orc_createas1b
    STORED AS ORC AS
    SELECT * FROM src
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@src
PREHOOK: Output: database:default
PREHOOK: Output: default@orc_createas1b
POSTHOOK: query: EXPLAIN CREATE TABLE orc_createas1b
    STORED AS ORC AS
    SELECT * FROM src
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@src
POSTHOOK: Output: database:default
POSTHOOK: Output: default@orc_createas1b
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE)

Stage-3
  Stats Work{}
    Stage-4
      Create Table{"name:":"default.orc_createas1b"}
        Stage-0
          Move Operator
            Stage-1
              Reducer 2
              File Output Operator [FS_12]
                Group By Operator [GBY_10] (rows=1 width=880)
                  Output:["_col0","_col1"],aggregations:["compute_stats(VALUE._col0)","compute_stats(VALUE._col1)"]
                <-Map 1 [CUSTOM_SIMPLE_EDGE]
                  File Output Operator [FS_2]
                    table:{"name:":"default.orc_createas1b"}
                    Select Operator [SEL_1] (rows=500 width=178)
                      Output:["_col0","_col1"]
                      TableScan [TS_0] (rows=500 width=178)
                        default@src,src,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                  PARTITION_ONLY_SHUFFLE [RS_9]
                    Group By Operator [GBY_8] (rows=1 width=880)
                      Output:["_col0","_col1"],aggregations:["compute_stats(col1, 'hll')","compute_stats(col2, 'hll')"]
                      Select Operator [SEL_7] (rows=500 width=178)
                        Output:["col1","col2"]
                         Please refer to the previous Select Operator [SEL_1]
        Stage-2
          Dependency Collection{}
             Please refer to the previous Stage-1

PREHOOK: query: CREATE TABLE orc_createas1b
    STORED AS ORC AS
    SELECT * FROM src
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@src
PREHOOK: Output: database:default
PREHOOK: Output: default@orc_createas1b
POSTHOOK: query: CREATE TABLE orc_createas1b
    STORED AS ORC AS
    SELECT * FROM src
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@src
POSTHOOK: Output: database:default
POSTHOOK: Output: default@orc_createas1b
POSTHOOK: Lineage: orc_createas1b.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: orc_createas1b.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
PREHOOK: query: EXPLAIN SELECT * FROM orc_createas1b ORDER BY key LIMIT 5
PREHOOK: type: QUERY
PREHOOK: Input: default@orc_createas1b
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: EXPLAIN SELECT * FROM orc_createas1b ORDER BY key LIMIT 5
POSTHOOK: type: QUERY
POSTHOOK: Input: default@orc_createas1b
POSTHOOK: Output: hdfs://### HDFS PATH ###
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:5
    Stage-1
      Reducer 2
      File Output Operator [FS_5]
        Limit [LIM_4] (rows=5 width=178)
          Number of rows:5
          Select Operator [SEL_3] (rows=500 width=178)
            Output:["_col0","_col1"]
          <-Map 1 [SIMPLE_EDGE]
            SHUFFLE [RS_2]
              Select Operator [SEL_1] (rows=500 width=178)
                Output:["_col0","_col1"]
                Top N Key Operator [TNK_6] (rows=500 width=178)
                  keys:key,top n:5
                  TableScan [TS_0] (rows=500 width=178)
                    default@orc_createas1b,orc_createas1b,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]

PREHOOK: query: SELECT * FROM orc_createas1b ORDER BY key LIMIT 5
PREHOOK: type: QUERY
PREHOOK: Input: default@orc_createas1b
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: SELECT * FROM orc_createas1b ORDER BY key LIMIT 5
POSTHOOK: type: QUERY
POSTHOOK: Input: default@orc_createas1b
POSTHOOK: Output: hdfs://### HDFS PATH ###
0	val_0
0	val_0
0	val_0
10	val_10
100	val_100
PREHOOK: query: EXPLAIN
    CREATE TABLE orc_createas1c
    STORED AS ORC AS 
        SELECT key, value, PMOD(HASH(key), 50) as part
        FROM orc_createas1a
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@orc_createas1a
PREHOOK: Input: default@orc_createas1a@ds=1
PREHOOK: Input: default@orc_createas1a@ds=2
PREHOOK: Output: database:default
PREHOOK: Output: default@orc_createas1c
POSTHOOK: query: EXPLAIN
    CREATE TABLE orc_createas1c
    STORED AS ORC AS 
        SELECT key, value, PMOD(HASH(key), 50) as part
        FROM orc_createas1a
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@orc_createas1a
POSTHOOK: Input: default@orc_createas1a@ds=1
POSTHOOK: Input: default@orc_createas1a@ds=2
POSTHOOK: Output: database:default
POSTHOOK: Output: default@orc_createas1c
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE)

Stage-3
  Stats Work{}
    Stage-4
      Create Table{"name:":"default.orc_createas1c"}
        Stage-0
          Move Operator
            Stage-1
              Reducer 2
              File Output Operator [FS_12]
                Group By Operator [GBY_10] (rows=1 width=1320)
                  Output:["_col0","_col1","_col2"],aggregations:["compute_stats(VALUE._col0)","compute_stats(VALUE._col1)","compute_stats(VALUE._col2)"]
                <-Map 1 [CUSTOM_SIMPLE_EDGE]
                  File Output Operator [FS_2]
                    table:{"name:":"default.orc_createas1c"}
                    Select Operator [SEL_1] (rows=1000 width=99)
                      Output:["_col0","_col1","_col2"]
                      TableScan [TS_0] (rows=1000 width=95)
                        default@orc_createas1a,orc_createas1a,Tbl:COMPLETE,Col:COMPLETE,Output:["key","value"]
                  PARTITION_ONLY_SHUFFLE [RS_9]
                    Group By Operator [GBY_8] (rows=1 width=1288)
                      Output:["_col0","_col1","_col2"],aggregations:["compute_stats(col1, 'hll')","compute_stats(col2, 'hll')","compute_stats(col3, 'hll')"]
                      Select Operator [SEL_7] (rows=1000 width=99)
                        Output:["col1","col2","col3"]
                         Please refer to the previous Select Operator [SEL_1]
        Stage-2
          Dependency Collection{}
             Please refer to the previous Stage-1

PREHOOK: query: CREATE TABLE orc_createas1c
    STORED AS ORC AS 
        SELECT key, value, PMOD(HASH(key), 50) as part
        FROM orc_createas1a
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@orc_createas1a
PREHOOK: Input: default@orc_createas1a@ds=1
PREHOOK: Input: default@orc_createas1a@ds=2
PREHOOK: Output: database:default
PREHOOK: Output: default@orc_createas1c
POSTHOOK: query: CREATE TABLE orc_createas1c
    STORED AS ORC AS 
        SELECT key, value, PMOD(HASH(key), 50) as part
        FROM orc_createas1a
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@orc_createas1a
POSTHOOK: Input: default@orc_createas1a@ds=1
POSTHOOK: Input: default@orc_createas1a@ds=2
POSTHOOK: Output: database:default
POSTHOOK: Output: default@orc_createas1c
POSTHOOK: Lineage: orc_createas1c.key SIMPLE [(orc_createas1a)orc_createas1a.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: orc_createas1c.part EXPRESSION [(orc_createas1a)orc_createas1a.FieldSchema(name:key, type:int, comment:null), ]
POSTHOOK: Lineage: orc_createas1c.value SIMPLE [(orc_createas1a)orc_createas1a.FieldSchema(name:value, type:string, comment:null), ]
PREHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(key, value) USING 'tr \t _' AS (c)
    FROM orc_createas1a
) t
PREHOOK: type: QUERY
PREHOOK: Input: default@orc_createas1a
PREHOOK: Input: default@orc_createas1a@ds=1
PREHOOK: Input: default@orc_createas1a@ds=2
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(key, value) USING 'tr \t _' AS (c)
    FROM orc_createas1a
) t
POSTHOOK: type: QUERY
POSTHOOK: Input: default@orc_createas1a
POSTHOOK: Input: default@orc_createas1a@ds=1
POSTHOOK: Input: default@orc_createas1a@ds=2
POSTHOOK: Output: hdfs://### HDFS PATH ###
14412220296
PREHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(key, value) USING 'tr \t _' AS (c)
    FROM orc_createas1c
) t
PREHOOK: type: QUERY
PREHOOK: Input: default@orc_createas1c
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
    SELECT TRANSFORM(key, value) USING 'tr \t _' AS (c)
    FROM orc_createas1c
) t
POSTHOOK: type: QUERY
POSTHOOK: Input: default@orc_createas1c
POSTHOOK: Output: hdfs://### HDFS PATH ###
14412220296
PREHOOK: query: DROP TABLE orc_createas1a
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@orc_createas1a
PREHOOK: Output: default@orc_createas1a
POSTHOOK: query: DROP TABLE orc_createas1a
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@orc_createas1a
POSTHOOK: Output: default@orc_createas1a
PREHOOK: query: DROP TABLE orc_createas1b
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@orc_createas1b
PREHOOK: Output: default@orc_createas1b
POSTHOOK: query: DROP TABLE orc_createas1b
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@orc_createas1b
POSTHOOK: Output: default@orc_createas1b
PREHOOK: query: DROP TABLE orc_createas1c
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@orc_createas1c
PREHOOK: Output: default@orc_createas1c
POSTHOOK: query: DROP TABLE orc_createas1c
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@orc_createas1c
POSTHOOK: Output: default@orc_createas1c
