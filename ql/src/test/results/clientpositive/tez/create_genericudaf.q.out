PREHOOK: query: EXPLAIN
CREATE TEMPORARY FUNCTION test_avg AS 'org.apache.hadoop.hive.ql.udf.generic.GenericUDAFAverage'
PREHOOK: type: CREATEFUNCTION
PREHOOK: Output: test_avg
POSTHOOK: query: EXPLAIN
CREATE TEMPORARY FUNCTION test_avg AS 'org.apache.hadoop.hive.ql.udf.generic.GenericUDAFAverage'
POSTHOOK: type: CREATEFUNCTION
POSTHOOK: Output: test_avg
Stage-0
  Create Function{"class:":"org.apache.hadoop.hive.ql.udf.generic.GenericUDAFAverage","name:":"test_avg","temporary:":"true"}

PREHOOK: query: CREATE TEMPORARY FUNCTION test_avg AS 'org.apache.hadoop.hive.ql.udf.generic.GenericUDAFAverage'
PREHOOK: type: CREATEFUNCTION
PREHOOK: Output: test_avg
POSTHOOK: query: CREATE TEMPORARY FUNCTION test_avg AS 'org.apache.hadoop.hive.ql.udf.generic.GenericUDAFAverage'
POSTHOOK: type: CREATEFUNCTION
POSTHOOK: Output: test_avg
PREHOOK: query: EXPLAIN
SELECT
    test_avg(1),
    test_avg(substr(value,5))
FROM src
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: EXPLAIN
SELECT
    test_avg(1),
    test_avg(substr(value,5))
FROM src
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: hdfs://### HDFS PATH ###
Plan optimized by CBO.

Vertex dependency in root stage
Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE)

Stage-0
  Fetch Operator
    limit:-1
    Stage-1
      Reducer 2
      File Output Operator [FS_7]
        Group By Operator [GBY_5] (rows=1 width=16)
          Output:["_col0","_col1"],aggregations:["test_avg(VALUE._col0)","test_avg(VALUE._col1)"]
        <-Map 1 [CUSTOM_SIMPLE_EDGE]
          PARTITION_ONLY_SHUFFLE [RS_4]
            Group By Operator [GBY_3] (rows=1 width=332)
              Output:["_col0","_col1"],aggregations:["test_avg(1)","test_avg(_col1)"]
              Select Operator [SEL_1] (rows=500 width=91)
                Output:["_col1"]
                TableScan [TS_0] (rows=500 width=91)
                  default@src,src,Tbl:COMPLETE,Col:COMPLETE,Output:["value"]

PREHOOK: query: SELECT
    test_avg(1),
    test_avg(substr(value,5))
FROM src
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: SELECT
    test_avg(1),
    test_avg(substr(value,5))
FROM src
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: hdfs://### HDFS PATH ###
1.0	260.182
PREHOOK: query: DROP TEMPORARY FUNCTIOn test_avg
PREHOOK: type: DROPFUNCTION
PREHOOK: Output: test_avg
POSTHOOK: query: DROP TEMPORARY FUNCTIOn test_avg
POSTHOOK: type: DROPFUNCTION
POSTHOOK: Output: test_avg
